@page "/popup.html"
@inject IJSRuntime JSRuntime

<div class="terminal">
    <div class="terminal-header">
        <span class="dot red" onclick="@(() => ChangeTheme(0))"></span>
        <span class="dot yellow" onclick="@(() => ChangeTheme(1))"></span>
        <span class="dot green"></span>
        
		<span class="spacer"></span>
        <div class="reset-box" @onclick="resetAllSettings">
            <h1>reset</h1>
        </div>
        <span class="version">v1.9</span>
        <a class="title" href="https://shaafyousaf.me" target="_blank">Slowed Enhanced</a>
    </div>
    @if(currentTheme == 0)
    {
        <div class="terminal-body">

        <div class="control-section">
            <div class="control-header">
                <span class="bracket">[</span><span class="property">volume</span><span class="bracket">]</span>
                <span class="value">@volume.ToString("F1")</span>
            </div>
            <input type="range" min="0" max="2" step="0.1" value="@volume" @oninput="OnVolumeChange" class="slider" />
            <div class="range-labels">
                <span>0.0</span>
                <span>2.0</span>
            </div>
        </div>

        <div class="control-section">
            <div class="control-header">
                <span class="bracket">[</span><span class="property">speed</span><span class="bracket">]</span>
                <span class="value">@speed.ToString("F1")x</span>
            </div>
            <input type="range" min="0.5" max="2" step="0.1" value="@speed" @oninput="OnSpeedChange" class="slider" />
            <div class="range-labels">
                <span>0.5x</span>
                <span> { granular time stretch && pitch preserved }</span>
                <span>2.0x</span>
            </div>
        </div>

        <div class="control-section">
            <div class="control-header">
                <span class="bracket">[</span><span class="property">reverb</span><span class="bracket">]</span>
                <span class="value">@reverb.ToString("P0")</span>
            </div>
            <input type="range" min="0" max="1" step="0.01" value="@reverb" @oninput="OnReverbChange" class="slider" />
            <div class="range-labels">
                <span>0%</span>
                <span> { low pass filter applied }</span>
                <span>100%</span>
            </div>
            <div class="reverb-grid">
                <div class="reverb-box">
                        <h1>/cove\</h1>
                </div>
                <div class="reverb-box">
                    <h1>|studio| </h1>
                </div>
                <div class="reverb-box">
                    <h1>\stadium/</h1>
                </div>
            </div>
        </div>
       
        @* <div class="status-line">
            <span class="status-ok">✓</span> <span class="status-text">settings applied</span>
        </div> *@
        <div class="status-line">
            @if(verror == 2)
            {
                <span class="status-ok">✓</span>
            } else
            {
                <span class="status-notok">✗</span>
            }
            
            
            <span class="status-text">volume applied</span>
            <span class="status-text"> | </span>
            @if (serror == 2)
            {
                <span class="status-ok">✓</span>
            }
            else
            {
                <span class="status-notok">✗</span>
            }

            <span class="status-text">speed applied</span>
            <span class="status-text"> | </span>
            @if (rerror == 2)
            {
                <span class="status-ok">✓</span>
            }
            else
            {
                <span class="status-notok">✗</span>
            }

            <span class="status-text">reverb applied</span>
        </div>
        </div>
    } else if (currentTheme == 1)
    {
        <div class="terminal-body">

            <div class="control-section">
                <div class="control-header">
                    <span class="property">volume
                        @if (verror == 2)
                        {
                            <span class="status-ok">✓</span>
                        }
                        else
                        {
                            <span class="status-notok">✗</span>
                        }
                    </span>
                    
                    <span class="value">@volume.ToString("F1")</span>
                </div>
                <input type="range" min="0.1" max="2" step="0.1" value="@volume" @oninput="OnVolumeChange" class="slider" />
                <div class="range-labels">
                    <span>0.1</span>
                    <span>2.0</span>
                </div>
            </div>

            <div class="control-section">
                <div class="control-header">
                    <span class="property">speed
                        @if (serror == 2)
                        {
                            <span class="status-ok">✓</span>
                        }
                        else
                        {
                            <span class="status-notok">✗</span>
                        }
                    </span>
                    <div class="reverb-grid">
                        <div class="pitch-box" @onclick="(() => PreservePitch())" style="@pitch">
                            <h1>preserve pitch</h1>
                        </div>
                    </div>
                    @if(speed == 1.0)
                    {
                        <span class="value inactive">@speed.ToString("F1")x</span>
                    } else
                    {
                        <span class="value active">@speed.ToString("F1")x</span>
                    }

                </div>
                <input type="range" min="0.5" max="2" step="0.1" value="@speed" @oninput="OnSpeedChange" class="slider" />
                <div class="range-labels">
                    <span>0.5x</span>
                    <span>granular time stretch && pitch preserved</span>
                    <span>2.0x</span>
                </div>
            </div>

            <div class="control-section">
                <div class="control-header">
                    <span class="property">reverb
                        @if (rerror == 2)
                        {
                            <span class="status-ok">✓</span>
                        }
                        else
                        {
                            <span class="status-notok">✗</span>
                        }
                    </span>
                    <div class="reverb-grid">
                        @if (reverb == 0.0)
                        {
                            <div class="reverb-box inactive-r" @onclick="(() => setReverbOption(1))" style="@cov">
                                <h1>cove</h1>
                            </div>
                            <div class="reverb-box inactive-r" @onclick="(() => setReverbOption(2))" style="@stu">
                                <h1>studio</h1>
                            </div>
                            <div class="reverb-box inactive-r" @onclick="(() => setReverbOption(3))" style="@sta">
                                <h1>stadium</h1>
                            </div>
                        }
                        else
                        {
                            <div class="reverb-box" @onclick="(() => setReverbOption(1))" style="@cov">
                                <h1>cove</h1>
                            </div>
                            <div class="reverb-box" @onclick="(() => setReverbOption(2))" style="@stu">
                                <h1>studio</h1>
                            </div>
                            <div class="reverb-box" @onclick="(() => setReverbOption(3))" style="@sta">
                                <h1>stadium</h1>
                            </div>
                        }

                    </div>
                    @if(reverb == 0.0)
                    {
                        <span class="value inactive">@reverb.ToString("P0")</span>
                    }
                    else
                    {
                        <span class="value active">@reverb.ToString("P0")</span>
					}
                </div>
                <input type="range" min="0" max="1" step="0.01" value="@reverb" @oninput="OnReverbChange" class="slider" />
                <div class="range-labels">
                    <span>0%</span>
                    <span>low pass filter applied</span>
                    <span>100%</span>
                </div>
                
            </div>

            @* <div class="status-line">
            <span class="status-ok">✓</span> <span class="status-text">settings applied</span>
        </div> *@
            
        </div>
    }
</div>